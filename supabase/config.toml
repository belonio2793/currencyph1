# Supabase Configuration

[app]
# This is required to enable Edge Functions in self-hosted Supabase
# Enable and set to true to activate edge functions
enable_http_edge_function_runner = true

[edge_runtime]
# Enable Edge Runtime
policy = "per_request"

# Cron Job Configuration for TripAdvisor Sync
[[functions]]
slug = "sync-tripadvisor-hourly"

[functions.scheduling]
# Run every hour at minute 0
cron = "0 * * * *"

# Cron Job Configuration for Web Scraping Nearby Listings
[[functions]]
slug = "scrape-nearby-listings"

[functions.scheduling]
# Run every 6 hours at minute 30
cron = "30 */6 * * *"

# Cron Job Configuration for Wallet Sync (legacy/full)
[[functions]]
slug = "sync-wallet-balances"

[functions.scheduling]
# Run every 5 minutes (legacy full sync - may time out if many wallets)
cron = "*/5 * * * *"

# Lightweight enqueue that will create short jobs (fast)
[[functions]]
slug = "enqueue-sync-wallets"

[functions.scheduling]
# Run every 5 minutes to enqueue a small batch
cron = "*/5 * * * *"

# Worker that processes one job per invocation (keeps each run short)
[[functions]]
slug = "process-sync-job"

[functions.scheduling]
# Run every minute to process queued jobs (short per-run work)
cron = "* * * * *"
